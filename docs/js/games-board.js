!function(){var e=window.GamesEngine,r=e.shuffle,t=e.pick,a=e.clamp;function n(){var e=document.createElement("div");return e.className="gflex-col bg-container",e.style.cssText="align-items:center;gap:6px;animation:bgFadeIn 0.4s ease",e}function o(e,r){return'<div class="bg-status" id="'+e+'">'+r+"</div>"}function s(e,r){return'<div class="bg-progress"><div class="bg-progress-fill" id="'+e+'" style="width:100%;background:'+(r||"linear-gradient(90deg,#FFD700,#FF6B35)")+'"></div></div>'}!function(){if(!document.getElementById("board-games-styles")){var e=document.createElement("style");e.id="board-games-styles",e.textContent="@keyframes bgShake{0%,100%{transform:translateX(0)}10%,30%,50%,70%,90%{transform:translateX(-4px)}20%,40%,60%,80%{transform:translateX(4px)}}@keyframes bgGlow{0%{box-shadow:0 0 5px #00C9A7}50%{box-shadow:0 0 25px #00C9A7,0 0 50px rgba(0,201,167,0.3)}100%{box-shadow:0 0 5px #00C9A7}}@keyframes bgPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}@keyframes bgPop{0%{transform:scale(0.3);opacity:0}60%{transform:scale(1.15)}100%{transform:scale(1);opacity:1}}@keyframes bgFlipIn{0%{transform:rotateY(90deg)}100%{transform:rotateY(0deg)}}@keyframes bgDrop{0%{transform:translateY(-200px);opacity:0}70%{transform:translateY(10px)}100%{transform:translateY(0);opacity:1}}@keyframes bgRipple{0%{box-shadow:0 0 0 0 rgba(0,150,255,0.4)}100%{box-shadow:0 0 0 15px rgba(0,150,255,0)}}@keyframes bgExplosion{0%{transform:scale(1)}30%{transform:scale(1.4)}100%{transform:scale(1)}}@keyframes bgSparkle{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.7;transform:scale(1.15)}}@keyframes bgSlide{0%{transform:translate(var(--sx),var(--sy))}100%{transform:translate(0,0)}}@keyframes bgWinFlash{0%,100%{background:rgba(255,215,0,0.3)}50%{background:rgba(255,215,0,0.7)}}@keyframes bgLightOn{0%{box-shadow:0 0 5px rgba(255,215,0,0.5)}100%{box-shadow:0 0 20px rgba(255,215,0,0.8),0 0 40px rgba(255,215,0,0.3)}}@keyframes bgCelebrate{0%{transform:scale(1) rotate(0deg)}25%{transform:scale(1.1) rotate(-2deg)}50%{transform:scale(1.15) rotate(2deg)}75%{transform:scale(1.1) rotate(-1deg)}100%{transform:scale(1) rotate(0deg)}}@keyframes bgRadar{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes bgFadeIn{0%{opacity:0;transform:translateY(8px)}100%{opacity:1;transform:translateY(0)}}@keyframes bgNeonPulse{0%,100%{border-color:rgba(0,201,167,0.6);box-shadow:0 0 8px rgba(0,201,167,0.3)}50%{border-color:rgba(0,201,167,1);box-shadow:0 0 20px rgba(0,201,167,0.6)}}@keyframes bgProgressFill{0%{width:100%}100%{width:0%}}@keyframes bgSwing{0%,100%{transform:translateX(0)}50%{transform:translateX(var(--swing-dist,30px))}}@keyframes bgCountDown{0%{transform:scale(1.5);opacity:1}100%{transform:scale(0.8);opacity:0.5}}.bg-container{background:linear-gradient(145deg,rgba(15,15,30,0.95),rgba(10,10,25,0.98));border:1px solid rgba(255,215,0,0.15);border-radius:16px;padding:20px;box-shadow:0 8px 32px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.05)}.bg-status{font-family:Inter,sans-serif;font-size:1rem;color:#e0e0e0;text-align:center;margin-bottom:12px;padding:8px 16px;background:rgba(255,255,255,0.04);border-radius:10px;border:1px solid rgba(255,255,255,0.06)}.bg-score{font-family:Orbitron,sans-serif;color:#FFD700;font-weight:700}.bg-progress{width:100%;height:6px;background:rgba(255,255,255,0.08);border-radius:3px;margin:8px 0;overflow:hidden}.bg-progress-fill{height:100%;border-radius:3px;transition:width 0.4s ease}",document.head.appendChild(e)}}(),e.register({id:"tic-tac-toe",name:"Tic-Tac-Toe",emoji:"â­•",category:"board",has2P:!0,init:function(r,t,a){var s=["","","","","","","","",""],i="p1",l=!1,d=n(),c="#FFD700",p="#00C9A7";d.innerHTML=o("tttStatus",'<span style="color:'+c+'">Your turn (ğŸŒ™)</span>')+'<div class="gboard" style="grid-template-columns:repeat(3,90px);gap:6px;padding:10px;background:rgba(0,0,0,0.3);border-radius:14px;border:1px solid rgba(0,201,167,0.2)" id="tttGrid"></div>',r.appendChild(d);for(var f=d.querySelector("#tttGrid"),g=[],b=0;b<9;b++){var u=document.createElement("div");u.className="gcell",u.style.cssText="height:90px;width:90px;font-size:2.4rem;display:flex;align-items:center;justify-content:center;background:linear-gradient(145deg,rgba(20,20,40,0.9),rgba(15,15,35,0.95));border:2px solid rgba(0,201,167,0.25);border-radius:12px;cursor:pointer;transition:all 0.25s ease;box-shadow:0 2px 8px rgba(0,0,0,0.3)",u.setAttribute("data-i",b),u.onmouseenter=function(){l||""!==s[parseInt(this.getAttribute("data-i"))]||(this.style.borderColor="rgba(0,201,167,0.7)",this.style.boxShadow="0 0 15px rgba(0,201,167,0.3)",this.style.transform="scale(1.05)")},u.onmouseleave=function(){this.classList.contains("ttt-win")||(this.style.borderColor="rgba(0,201,167,0.25)",this.style.boxShadow="0 2px 8px rgba(0,0,0,0.3)",this.style.transform="scale(1)")},f.appendChild(u),g.push(u)}var h=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function y(e){return h.some(function(r){return s[r[0]]===e&&s[r[1]]===e&&s[r[2]]===e})}function m(){g.forEach(function(e,r){e.textContent=s[r],"ğŸŒ™"===s[r]?(e.style.background="linear-gradient(145deg,rgba(255,215,0,0.15),rgba(255,215,0,0.05))",e.style.borderColor="rgba(255,215,0,0.4)"):"â­"===s[r]&&(e.style.background="linear-gradient(145deg,rgba(0,201,167,0.15),rgba(0,201,167,0.05))",e.style.borderColor="rgba(0,201,167,0.4)")})}function x(e,r,t){if(y("â­"))return 10-t;if(y("ğŸŒ™"))return t-10;if(e.every(function(e){return""!==e}))return 0;for(var a=r?-100:100,n=0;n<9;n++)if(""===e[n]){e[n]=r?"â­":"ğŸŒ™";var o=x(e,!r,t+1);e[n]="",a=r?Math.max(a,o):Math.min(a,o)}return a}function v(){var e=[];if(s.forEach(function(r,t){""===r&&e.push(t)}),0!==e.length){if("easy"===a){var r=e[Math.floor(Math.random()*e.length)];return s[r]="â­",m(),g[r].style.animation="bgPop 0.4s ease",void S("â­")}if("hard"===a){for(var t=-100,n=e[0],o=0;o<e.length;o++){s[e[o]]="â­";var i=x(s,!1,0);s[e[o]]="",i>t&&(t=i,n=e[o])}return s[n]="â­",m(),g[n].style.animation="bgPop 0.4s ease",void S("â­")}for(o=0;o<e.length;o++){if(s[e[o]]="â­",y("â­"))return m(),g[e[o]].style.animation="bgPop 0.4s ease",void S("â­");s[e[o]]=""}for(var l=0;l<e.length;l++){if(s[e[l]]="ğŸŒ™",y("ğŸŒ™"))return s[e[l]]="â­",m(),g[e[l]].style.animation="bgPop 0.4s ease",void S("â­");s[e[l]]=""}var d=e.indexOf(4)>-1?4:e[Math.floor(Math.random()*e.length)];s[d]="â­",m(),g[d].style.animation="bgPop 0.4s ease",S("â­")}}function S(r){if(y(r)){l=!0,h.forEach(function(e){s[e[0]]===r&&s[e[1]]===r&&s[e[2]]===r&&[e[0],e[1],e[2]].forEach(function(e){g[e].classList.add("ttt-win"),g[e].style.animation="bgWinFlash 0.6s ease infinite",g[e].style.borderColor="#FFD700",g[e].style.boxShadow="0 0 25px rgba(255,215,0,0.6)",g[e].style.transform="scale(1.1)"})});var a="ğŸŒ™"===r?"You win!":"2p"===t?"Player 2 wins!":"Rashid wins!";return d.querySelector("#tttStatus").innerHTML='<span style="font-size:1.2rem;color:#FFD700">'+a+" ğŸ‰</span>",d.querySelector("#tttStatus").style.animation="bgCelebrate 0.8s ease",e.rashidSay("ğŸŒ™"===r?"Great move! ğŸ‰":"I win! ğŸ˜"),void e.endGame("ğŸŒ™"===r?1:0,1)}if(s.every(function(e){return""!==e}))return l=!0,d.querySelector("#tttStatus").innerHTML='<span style="color:#FFD700">Draw! ğŸ¤</span>',e.rashidSay("Good game! ğŸ¤"),void e.endGame(0,1);var n="p1"===(i="p1"===i?"p2":"p1")?c:p,o="p1"===i?"Your turn (ğŸŒ™)":"2p"===t?"Player 2 (â­)":"Rashid thinking...";d.querySelector("#tttStatus").innerHTML='<span style="color:'+n+'">'+o+"</span>","p2"===i&&"1p"===t&&setTimeout(v,500)}return g.forEach(function(e,r){e.onclick=function(){l||""!==s[r]||("p1"===i?(s[r]="ğŸŒ™",m(),g[r].style.animation="bgPop 0.4s ease",S("ğŸŒ™")):"2p"===t&&(s[r]="â­",m(),g[r].style.animation="bgPop 0.4s ease",S("â­")))}}),m(),{}},destroy:function(){}}),e.register({id:"connect-four",name:"Connect Four",emoji:"ğŸ”´",category:"board",has2P:!0,init:function(r,a,s){for(var i=[],l=0;l<7;l++){i[l]=[];for(var d=0;d<6;d++)i[l][d]=""}var c="p1",p=!1,f=n();f.innerHTML=o("c4Status",'<span style="color:#ff4444">Your turn (ğŸ”´)</span>')+'<div class="gboard" style="grid-template-columns:repeat(7,52px);gap:4px;padding:14px;background:linear-gradient(180deg,rgba(0,0,80,0.4),rgba(0,0,60,0.6));border-radius:14px;border:2px solid rgba(0,100,200,0.3)" id="c4Grid"></div>',r.appendChild(f);for(var g=f.querySelector("#c4Grid"),b=[],u=-1,h=0;h<6;h++)for(var y=0;y<7;y++){var m=document.createElement("div");m.className="gcell",m.style.cssText="height:52px;width:52px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;background:radial-gradient(circle at 35% 35%,rgba(30,30,60,0.9),rgba(10,10,30,0.95));border:2px solid rgba(100,100,200,0.2);transition:all 0.2s ease;box-shadow:inset 0 2px 8px rgba(0,0,0,0.5)",m.setAttribute("data-c",y),m.setAttribute("data-r",h),m.onmouseenter=function(){if(!p){var e=parseInt(this.getAttribute("data-c"));if(u!==e){u=e;for(var r=0;r<6;r++)""===i[e][r]&&(b[e][r].style.borderColor="rgba(255,215,0,0.4)")}}},m.onmouseleave=function(){for(var e=parseInt(this.getAttribute("data-c")),r=0;r<6;r++)""===i[e][r]&&(b[e][r].style.borderColor="rgba(100,100,200,0.2)");u=-1},g.appendChild(m),b[y]||(b[y]=[]),b[y][h]=m}function x(){for(var e=0;e<7;e++)for(var r=0;r<6;r++){var t=b[e][r];t.textContent=i[e][r],"ğŸ”´"===i[e][r]?(t.style.background="radial-gradient(circle at 35% 35%,#ff6666,#cc0000,#880000)",t.style.borderColor="rgba(255,50,50,0.6)",t.style.boxShadow="0 0 10px rgba(255,0,0,0.3),inset 0 2px 4px rgba(255,255,255,0.2)"):"ğŸŸ¡"===i[e][r]?(t.style.background="radial-gradient(circle at 35% 35%,#ffee55,#ffcc00,#cc9900)",t.style.borderColor="rgba(255,215,0,0.6)",t.style.boxShadow="0 0 10px rgba(255,215,0,0.3),inset 0 2px 4px rgba(255,255,255,0.2)"):(t.style.background="radial-gradient(circle at 35% 35%,rgba(30,30,60,0.9),rgba(10,10,30,0.95))",t.style.borderColor="rgba(100,100,200,0.2)",t.style.boxShadow="inset 0 2px 8px rgba(0,0,0,0.5)")}}function v(e){for(var r=5;r>=0;r--)if(""===i[e][r])return r;return-1}function S(e){for(var r=0;r<7;r++)for(var t=0;t<6;t++){if(r+3<7&&i[r][t]===e&&i[r+1][t]===e&&i[r+2][t]===e&&i[r+3][t]===e)return[[r,t],[r+1,t],[r+2,t],[r+3,t]];if(t+3<6&&i[r][t]===e&&i[r][t+1]===e&&i[r][t+2]===e&&i[r][t+3]===e)return[[r,t],[r,t+1],[r,t+2],[r,t+3]];if(r+3<7&&t+3<6&&i[r][t]===e&&i[r+1][t+1]===e&&i[r+2][t+2]===e&&i[r+3][t+3]===e)return[[r,t],[r+1,t+1],[r+2,t+2],[r+3,t+3]];if(r+3<7&&t-3>=0&&i[r][t]===e&&i[r+1][t-1]===e&&i[r+2][t-2]===e&&i[r+3][t-3]===e)return[[r,t],[r+1,t-1],[r+2,t-2],[r+3,t-3]]}return null}function w(e){return null!==S(e)}function C(r,t){var n=v(r);if(n<0)return!1;i[r][n]=t,x(),b[r][n].style.animation="none",b[r][n].offsetHeight,b[r][n].style.animation="bgDrop 0.4s ease";var o=S(t);if(o){p=!0,o.forEach(function(e){b[e[0]][e[1]].style.animation="bgWinFlash 0.5s ease infinite",b[e[0]][e[1]].style.transform="scale(1.1)"});var s="ğŸ”´"===t?"You win!":"Player 2 wins!";return"ğŸŸ¡"===t&&"1p"===a&&(s="Rashid wins!"),f.querySelector("#c4Status").innerHTML='<span style="color:#FFD700;font-size:1.1rem">'+s+" ğŸ‰</span>",e.endGame("ğŸ”´"===t?1:0,1),!0}if(function(){for(var e=0;e<7;e++)if(""===i[e][0])return!1;return!0}())return p=!0,f.querySelector("#c4Status").innerHTML='<span style="color:#FFD700">Draw! ğŸ¤</span>',e.endGame(0,1),!0;var l="p1"===(c="p1"===c?"p2":"p1")?"#ff4444":"#ffcc00",d="p1"===c?"Your turn (ğŸ”´)":"2p"===a?"Player 2 (ğŸŸ¡)":"Rashid...";return f.querySelector("#c4Status").innerHTML='<span style="color:'+l+'">'+d+"</span>",!0}function k(){for(var e="ğŸŸ¡",r="ğŸ”´",a=[],n=0;n<7;n++)v(n)>=0&&a.push(n);if(0!==a.length)if("easy"!==s){for(var o=0;o<7;o++){var l=v(o);if(!(l<0)){if(i[o][l]=e,w(e))return i[o][l]="",void C(o,e);i[o][l]=""}}for(var d=0;d<7;d++){var c=v(d);if(!(c<0)){if(i[d][c]=r,w(r))return i[d][c]="",void C(d,e);i[d][c]=""}}if("hard"===s){var p=a.filter(function(t){var a=v(t);if(a<=0)return!0;i[t][a]=e,i[t][a-1]=r;var n=w(r);return i[t][a-1]="",i[t][a]="",!n});0===p.length&&(p=a);var f=p[0],g=-1;return p.forEach(function(r){var t=function(e,r){var t=v(r);if(t<0)return 0;i[r][t]=e;for(var a=0,n=0;n<7;n++)for(var o=0;o<6;o++)[[1,0],[0,1],[1,1],[1,-1]].forEach(function(r){for(var t=0,s=0,l=0;l<4;l++){var d=n+r[0]*l,c=o+r[1]*l;if(d<0||d>=7||c<0||c>=6)return;if(i[d][c]===e)t++;else{if(""!==i[d][c])return;s++}}3===t&&1===s&&a++});return i[r][t]="",a}(e,r);t>g&&(g=t,f=r)}),void C(f,e)}a.indexOf(3)>-1?C(3,e):C(t(a),e)}else C(t(a),e)}return g.onclick=function(e){if(!p){var r=e.target;if(r.hasAttribute("data-c")){var t=parseInt(r.getAttribute("data-c"));"p1"===c?C(t,"ğŸ”´")&&!p&&"1p"===a&&setTimeout(k,400):"2p"===a&&C(t,"ğŸŸ¡")}}},x(),{}},destroy:function(){}}),e.register({id:"memory-cards",name:"Memory Cards",emoji:"ğŸƒ",category:"board",has2P:!1,init:function(t,a,i){var l="easy"===i?6:"hard"===i?10:8,d="easy"===i?3:"hard"===i?5:4,c=2*l,p=r(["ğŸ•Œ","ğŸ—¼","ğŸª","ğŸ¦…","ğŸŒ´","ğŸœï¸","ğŸ’","ğŸª™","ğŸ«","ğŸ­"]).slice(0,l),f=r(p.concat(p)),g=[],b=[],u=0,h=!1,y=n();y.innerHTML=o("memStatus",'ğŸƒ <span class="bg-score">Moves: 0</span> &nbsp;|&nbsp; Pairs: 0/'+l)+s("memPeekBar","linear-gradient(90deg,#FF6B35,#FFD700)")+'<div style="font-family:Inter,sans-serif;font-size:0.75rem;color:rgba(255,255,255,0.4);margin-bottom:6px">Memorize the cards!</div><div class="gboard" style="grid-template-columns:repeat('+d+',68px);gap:6px;padding:10px;background:rgba(0,0,0,0.2);border-radius:14px" id="memGrid"></div><div id="memRating" style="font-family:Inter,sans-serif;font-size:0.85rem;color:rgba(255,255,255,0.5);margin-top:8px"></div>',t.appendChild(y);for(var m=y.querySelector("#memGrid"),x=[],v=0;v<c;v++){var S=document.createElement("div");S.className="gcell",S.style.cssText="height:68px;width:68px;font-size:1.8rem;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#1a1a3e,#2a1a4e);border:2px solid rgba(155,89,182,0.4);border-radius:10px;cursor:pointer;transition:transform 0.3s ease,box-shadow 0.3s ease,background 0.3s ease;box-shadow:0 3px 10px rgba(0,0,0,0.4);perspective:600px",S.textContent="â“",S.setAttribute("data-i",v),S.onmouseenter=function(){h||-1!==b.indexOf(parseInt(this.getAttribute("data-i")))||(this.style.transform="scale(1.06)")},S.onmouseleave=function(){this.classList.contains("mem-matched")||(this.style.transform="scale(1)")},m.appendChild(S),x.push(S)}function w(e){x[e].textContent=f[e],x[e].style.background="linear-gradient(135deg,rgba(255,215,0,0.15),rgba(155,89,182,0.15))",x[e].style.borderColor="rgba(255,215,0,0.5)",x[e].style.animation="bgFlipIn 0.3s ease"}function C(e){x[e].textContent="â“",x[e].style.background="linear-gradient(135deg,#1a1a3e,#2a1a4e)",x[e].style.borderColor="rgba(155,89,182,0.4)",x[e].style.animation="bgFlipIn 0.3s ease",x[e].style.boxShadow="0 3px 10px rgba(0,0,0,0.4)"}h=!0;for(var k=0;k<c;k++)w(k);var F=y.querySelector("#memPeekBar");return F.style.transition="width 1.2s linear",setTimeout(function(){F.style.width="0%"},50),setTimeout(function(){for(var e=0;e<c;e++)C(e);h=!1,F.parentNode.style.display="none",y.querySelector("#memStatus").nextElementSibling.nextElementSibling.style.display="none"},1200),m.onclick=function(r){if(!h){var t=r.target;if(t.hasAttribute("data-i")){var a,n,o=parseInt(t.getAttribute("data-i"));if(!(b.indexOf(o)>-1||g.indexOf(o)>-1))if(w(o),g.push(o),2===g.length)if(u++,y.querySelector("#memStatus").innerHTML='ğŸƒ <span class="bg-score">Moves: '+u+"</span> &nbsp;|&nbsp; Pairs: "+b.length/2+"/"+l,n=(a=l>0?u/l:0)<=1.5?"â­â­â­":a<=2.5?"â­â­":"â­",y.querySelector("#memRating").textContent="Rating: "+n,h=!0,f[g[0]]===f[g[1]]){b.push(g[0],g[1]);var s=g[0],i=g[1];x[s].classList.add("mem-matched"),x[i].classList.add("mem-matched"),x[s].style.animation="bgSparkle 0.6s ease",x[i].style.animation="bgSparkle 0.6s ease",x[s].style.boxShadow="0 0 20px rgba(0,201,167,0.5)",x[i].style.boxShadow="0 0 20px rgba(0,201,167,0.5)",x[s].style.borderColor="rgba(0,201,167,0.6)",x[i].style.borderColor="rgba(0,201,167,0.6)",y.querySelector("#memStatus").innerHTML='ğŸƒ <span class="bg-score">Moves: '+u+"</span> &nbsp;|&nbsp; Pairs: "+b.length/2+"/"+l,g=[],h=!1,b.length===c&&(e.rashidSay("All matched! ğŸ‰"),y.querySelector("#memStatus").innerHTML='<span style="color:#FFD700;font-size:1.1rem">All matched in '+u+" moves! ğŸ‰</span>",y.querySelector("#memStatus").style.animation="bgCelebrate 0.8s ease",e.endGame(Math.max(1,3*l-u),3*l))}else{var d=g.slice();x[d[0]].style.boxShadow="0 0 15px rgba(255,50,50,0.5)",x[d[1]].style.boxShadow="0 0 15px rgba(255,50,50,0.5)",setTimeout(function(){C(d[0]),C(d[1]),g=[],h=!1},800)}}}},{}},destroy:function(){}}),e.register({id:"battleship",name:"Battleship",emoji:"ğŸš¢",category:"board",has2P:!0,_tv:[],init:function(a,o,s){var i="easy"===s?8:"hard"===s?10:9,l=i<=8?42:i<=9?38:34,d=[{name:"Patrol Boat",len:2,pts:2,emoji:"ğŸš¤",color:"#4ecdc4"},{name:"Submarine",len:3,pts:3,emoji:"ğŸ”±",color:"#9b59b6"},{name:"Destroyer",len:4,pts:4,emoji:"ğŸš¢",color:"#FFD700"},{name:"Carrier",len:5,pts:5,emoji:"â›´ï¸",color:"#FF6B35"}],c=14,p=this;function f(){for(var e=[],r=0;r<i;r++){e[r]=[];for(var t=0;t<i;t++)e[r][t]={ship:-1,hit:!1}}return{grid:e,ships:[],score:0,placed:!1}}p._tv=[];var g=[f(),f()],b=0,u=!1,h=n();function y(e,r,t,a,n){for(var o=0;o<a;o++){var s=n?r:r+o,l=n?t+o:t;if(s>=i||l>=i)return!1;if(-1!==g[e].grid[s][l].ship)return!1}return!0}function m(e,r,t,a,n){for(var o=[],s=0;s<a;s++){var i=n?r:r+s,l=n?t+s:t;g[e].grid[i][l].ship=g[e].ships.length,o.push({r:i,c:l})}g[e].ships.push({cells:o,sunk:!1,def:d[g[e].ships.length],horiz:n})}function x(e,r,t){var a=t||1,n=e.def.color,o=0===r,s=r===e.cells.length-1,i="2px";return e.horiz?o?i="14px 4px 4px 14px":s&&(i="4px 14px 14px 4px"):o?i="14px 14px 4px 4px":s&&(i="4px 4px 14px 14px"),"background:"+("linear-gradient("+(e.horiz?"180deg":"90deg")+","+n+(a<1?"44":"cc")+","+n+(a<1?"22":"88")+")")+";border:"+("1.5px solid "+n+(a<1?"55":""))+";border-radius:"+i+";box-shadow:"+(a<1?"none":"0 0 8px "+n+"33,inset 0 1px 0 rgba(255,255,255,0.15)")+";"}function v(e,r){return 0===r?e.def.emoji:r===e.cells.length-1?e.horiz?"â–¸":"â–¾":e.horiz?"â”":"â”ƒ"}function S(e,r){for(var t=g[e].ships[r],a=0;a<t.cells.length;a++)if(!g[e].grid[t.cells[a].r][t.cells[a].c].hit)return!1;return!0}function w(e){for(var r=0;r<g[e].ships.length;r++)if(!g[e].ships[r].sunk)return!1;return g[e].ships.length>0}function C(){return"height:"+l+"px;width:"+l+"px;font-size:0.85rem;display:flex;align-items:center;justify-content:center;border-radius:6px;transition:all 0.2s;"}function k(){return"background:linear-gradient(180deg,rgba(0,60,120,0.4),rgba(0,40,80,0.6));border:1px solid rgba(0,100,200,0.2);color:rgba(100,180,255,0.4);cursor:pointer;"}function F(){return"grid-template-columns:repeat("+i+","+l+"px);gap:2px;padding:6px;background:linear-gradient(180deg,rgba(0,30,60,0.6),rgba(0,20,50,0.8));border-radius:12px;border:1.5px solid rgba(0,100,200,0.2);transition:border-color 0.3s"}function T(e){var r=g[e].ships.length,t=!0,a=0===e?"#4ecdc4":"#ff6b6b",n="2p"===o?0===e?"Player 1":"Player 2":"Captain";h.innerHTML="";var s=document.createElement("div");s.className="bg-status",s.id="bsPlSt",s.innerHTML='ğŸš¢ <span style="color:'+a+'">'+n+"</span> â€” Place your fleet!",h.appendChild(s);var l=document.createElement("div");l.id="bsShipInf",l.style.cssText="text-align:center;margin-bottom:6px;font-size:0.82rem;color:rgba(255,255,255,0.7)",h.appendChild(l);var c=document.createElement("div");c.id="bsRoster",c.style.cssText="display:flex;gap:8px;justify-content:center;margin-bottom:8px;flex-wrap:wrap";for(var p=0;p<d.length;p++){var f=document.createElement("div");f.style.cssText="padding:4px 10px;border-radius:8px;font-size:0.72rem;font-family:Orbitron,sans-serif;border:1.5px solid "+d[p].color+"33;color:"+d[p].color+";background:rgba(0,0,0,0.2);transition:all 0.3s",f.textContent=d[p].emoji+" "+d[p].len+" cells",f.id="bsChip"+p,c.appendChild(f)}h.appendChild(c);var b=document.createElement("div");b.style.cssText="display:flex;gap:8px;justify-content:center;margin-bottom:6px";var u=document.createElement("button");u.style.cssText="padding:6px 14px;border:1.5px solid rgba(255,215,0,0.3);border-radius:8px;background:rgba(255,255,255,0.06);color:#FFD700;cursor:pointer;font-family:Orbitron,sans-serif;font-size:0.72rem;transition:all 0.2s",u.textContent="ğŸ”„ Horizontal",u.onclick=function(){t=!t,u.textContent=t?"ğŸ”„ Horizontal":"ğŸ”„ Vertical"},b.appendChild(u),h.appendChild(b);var S=document.createElement("div");S.className="gboard",S.style.cssText=F(),h.appendChild(S);for(var w=[],T=0;T<i*i;T++){var P=document.createElement("div");P.className="gcell",P.style.cssText=C()+k(),P.textContent="~",P.setAttribute("data-r",Math.floor(T/i)),P.setAttribute("data-c",T%i),P.onmouseenter=function(){if(!(r>=d.length))for(var a=parseInt(this.getAttribute("data-r")),n=parseInt(this.getAttribute("data-c")),o=y(e,a,n,d[r].len,t),s=0;s<d[r].len;s++){var l=t?a:a+s,c=t?n+s:n;l<i&&c<i&&-1===g[e].grid[l][c].ship&&(w[l*i+c].style.background=o?"rgba(0,201,167,0.25)":"rgba(255,50,50,0.25)",w[l*i+c].style.borderColor=o?"rgba(0,201,167,0.6)":"rgba(255,50,50,0.6)")}},P.onmouseleave=function(){for(var r=0;r<w.length;r++){var t=Math.floor(r/i),a=r%i;-1===g[e].grid[t][a].ship&&(w[r].style.background="",w[r].style.borderColor="",w[r].style.cssText=C()+k())}},P.onclick=function(){if(!(r>=d.length)){var n=parseInt(this.getAttribute("data-r")),s=parseInt(this.getAttribute("data-c"));if(y(e,n,s,d[r].len,t)){m(e,n,s,d[r].len,t);for(var l=g[e].ships[g[e].ships.length-1],c=0;c<l.cells.length;c++){var p=l.cells[c].r*i+l.cells[c].c;w[p].style.cssText=C()+x(l,c)+"color:#fff;cursor:default;font-size:"+(0===c?"1rem":"0.7rem")+";",w[p].textContent=v(l,c)}var f=document.getElementById("bsChip"+r);if(f&&(f.style.background=d[r].color+"22",f.style.borderColor=d[r].color,f.style.textDecoration="line-through"),r++,A(),r>=d.length){g[e].placed=!0;var b=document.createElement("button");b.style.cssText="margin-top:10px;padding:12px 28px;border:none;border-radius:10px;background:linear-gradient(135deg,#FFD700,#FFA500);color:#000;font-family:Orbitron,sans-serif;font-size:0.85rem;font-weight:700;cursor:pointer;display:block;margin-left:auto;margin-right:auto;transition:all 0.2s",b.textContent="âœ… Ready for Battle!",b.onmouseenter=function(){this.style.transform="scale(1.05)"},b.onmouseleave=function(){this.style.transform="scale(1)"},b.onclick=function(){"2p"===o&&0===e?M():E()},h.appendChild(b),document.getElementById("bsPlSt").innerHTML='âœ… <span style="color:'+a+'">Fleet placed!</span> Ready for battle!'}}}},S.appendChild(P),w.push(P)}function A(){var e=document.getElementById("bsShipInf");if(e)if(r>=d.length)e.innerHTML='<span style="color:#00C9A7">All ships placed! Hit Ready!</span>';else{var t=d[r];e.innerHTML="Placing: "+t.emoji+' <strong style="color:'+t.color+'">'+t.name+"</strong> â€” "+t.len+" cells ("+t.pts+" pts)"}}A()}function M(){h.innerHTML='<div style="text-align:center;padding:40px 20px"><div style="font-size:3rem;margin-bottom:16px">ğŸ”„</div><div style="font-family:Orbitron,sans-serif;font-size:1.1rem;color:#FFD700;margin-bottom:10px">Pass to Player 2!</div><div style="color:rgba(255,255,255,0.6);font-size:0.85rem;margin-bottom:20px">Don\'t peek! P2 needs to place their ships.</div></div>';var e=document.createElement("button");e.style.cssText="display:block;margin:0 auto;padding:14px 32px;border:none;border-radius:10px;background:linear-gradient(135deg,#ff6b6b,#ff4444);color:#fff;font-family:Orbitron,sans-serif;font-size:0.85rem;font-weight:700;cursor:pointer;transition:all 0.2s",e.textContent="I'm Player 2 â€” Let's Go!",e.onclick=function(){T(1)},h.appendChild(e)}h.style.maxWidth="720px",a.appendChild(h);var P=[[],[]];function E(){b=0,u=!1,h.innerHTML="";var r=document.createElement("div");r.className="bg-status",r.id="bsBattSt",h.appendChild(r);var a=document.createElement("div");a.id="bsScRow",a.style.cssText="display:flex;justify-content:center;gap:16px;margin-bottom:6px;font-family:Orbitron,sans-serif;font-size:0.78rem",h.appendChild(a);var n=document.createElement("div");n.id="bsShipRow",n.style.cssText="display:flex;justify-content:center;gap:12px;margin-bottom:8px;font-size:0.72rem;flex-wrap:wrap",h.appendChild(n);var s=document.createElement("div");s.style.cssText="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;width:100%",h.appendChild(s);for(var d=0;d<2;d++){P[d]=[];var c=document.createElement("div");c.style.cssText="text-align:center;flex:1;min-width:"+(l*i+14)+"px";var p=document.createElement("div");p.id="bsBLbl"+d,p.style.cssText="font-family:Orbitron,sans-serif;font-size:0.68rem;margin-bottom:3px;letter-spacing:1px;transition:all 0.3s",p.textContent="2p"===o?0===d?"P1's FLEET":"P2's FLEET":0===d?"YOUR FLEET":"ENEMY WATERS",c.appendChild(p);var f=document.createElement("div");f.className="gboard",f.id="bsBG"+d,f.style.cssText=F(),c.appendChild(f),s.appendChild(c);for(var y=0;y<i*i;y++){var m=Math.floor(y/i),S=y%i,w=document.createElement("div");w.className="gcell",w.setAttribute("data-r",m),w.setAttribute("data-c",S),w.setAttribute("data-p",d);var T=-1!==g[d].grid[m][S].ship;if("1p"===o&&0===d&&T){for(var M=g[d].grid[m][S].ship,E=g[d].ships[M],L=0,B=0;B<E.cells.length;B++)if(E.cells[B].r===m&&E.cells[B].c===S){L=B;break}w.style.cssText=C()+x(E,L,.5)+"color:"+E.def.color+"88;cursor:default;font-size:"+(0===L?"0.85rem":"0.65rem")+";",w.textContent=v(E,L)}else w.style.cssText=C()+k(),w.textContent="~";f.appendChild(w),P[d].push(w)}f.onclick=function(e){return function(r){if(!u){var t=r.target;if(t.hasAttribute("data-r")){var a=parseInt(t.getAttribute("data-r")),n=parseInt(t.getAttribute("data-c"));A(e,a,n)}}}}(d)}H(),e.rashidSay(t(["Battle stations! ğŸš¢","Fire at will! ğŸ’¥","Yalla, sink 'em! âš“"]))}function A(r,a,n){if("1p"!==o||1===r)if("2p"!==o||r===(0===b?1:0)){if("1p"!==o||0===b){var s=g[r].grid[a][n];if(s.hit)e.rashidSay("Already fired there! ğŸ”„");else{s.hit=!0;var l=P[r][a*i+n],d=!1;if(-1!==s.ship){d=!0,l.textContent="ğŸ’¥",l.style.cssText=C()+"background:radial-gradient(circle,rgba(255,50,50,0.5),rgba(200,0,0,0.2));border:1.5px solid rgba(255,50,50,0.6);box-shadow:0 0 15px rgba(255,50,50,0.4);animation:bgExplosion 0.5s ease;font-size:1.1rem;cursor:default;";var f=g[r].ships[s.ship];if(S(r,s.ship)){f.sunk=!0;var h=f.def.pts;g[b].score+=h,e.setScore("1p"===o?g[0].score:Math.max(g[0].score,g[1].score));for(var y=0;y<f.cells.length;y++){var m=P[r][f.cells[y].r*i+f.cells[y].c],x="2px";f.horiz?0===y?x="14px 4px 4px 14px":y===f.cells.length-1&&(x="4px 14px 14px 4px"):0===y?x="14px 14px 4px 4px":y===f.cells.length-1&&(x="4px 4px 14px 14px"),m.textContent=0===y?"ğŸ”¥":"ğŸ’€",m.style.cssText=C()+"background:radial-gradient(circle,rgba(255,100,0,0.4),rgba(200,50,0,0.2));border:1.5px solid rgba(255,100,0,0.6);box-shadow:0 0 18px rgba(255,100,0,0.5);border-radius:"+x+";font-size:0.9rem;cursor:default;"}var v="1p"===o?"":0===b?"P1 ":"P2 ";if(e.rashidSay(v+"sank "+f.def.emoji+" "+f.def.name+"! +"+h+"pts! Keep firing! ğŸ¯"),w(r)){u=!0;var k="1p"===o?"You":0===b?"Player 1":"Player 2",F=0===b?"#4ecdc4":"#ff6b6b";return document.getElementById("bsBattSt").innerHTML='<span style="color:'+F+';font-size:1.05rem">'+k+" wins! All ships sunk! ğŸ‰</span>",document.getElementById("bsBattSt").style.animation="bgCelebrate 0.8s ease",void e.endGame(g[b].score,c)}}else{var T="1p"===o?"":0===b?"P1: ":"P2: ";e.rashidSay(T+t(["Direct hit! Fire again! ğŸ’¥","Hit! Keep going! ğŸ”¥","Boom! Another shot! ğŸ’£"]))}}else l.textContent="ğŸ’¨",l.style.cssText=C()+"background:linear-gradient(180deg,rgba(0,40,80,0.3),rgba(0,20,50,0.4));border:1px solid rgba(0,80,160,0.2);animation:bgRipple 0.6s ease;color:rgba(100,180,255,0.3);cursor:default;";d||(b=1-b),H(),"1p"!==o||1!==b||u||p._tv.push(setTimeout(function(){B()},700))}}}else e.rashidSay(0===b?"Fire at P2's fleet! â¡ï¸":"Fire at P1's fleet! â¬…ï¸");else e.rashidSay("Attack the enemy waters! â¡ï¸")}var L=[];function B(){if(!u){for(var a,n,o=!1,s=r([[-1,0],[1,0],[0,-1],[0,1]]),l=0;l<L.length&&!o;l++)for(var d=0;d<s.length&&!o;d++)a=L[l].r+s[d][0],n=L[l].c+s[d][1],a>=0&&a<i&&n>=0&&n<i&&!g[0].grid[a][n].hit&&(o=!0);if(!o){var f=0;do{a=Math.floor(Math.random()*i),n=Math.floor(Math.random()*i),f++}while(g[0].grid[a][n].hit&&f<300);if(f>=300)return}g[0].grid[a][n].hit=!0;var h=P[0][a*i+n],y=!1;if(-1!==g[0].grid[a][n].ship){y=!0,h.textContent="ğŸ’¥",h.style.cssText=C()+"background:radial-gradient(circle,rgba(255,50,50,0.5),rgba(200,0,0,0.2));border:1.5px solid rgba(255,50,50,0.6);box-shadow:0 0 15px rgba(255,50,50,0.4);animation:bgExplosion 0.5s ease;font-size:1.1rem;cursor:default;",L.push({r:a,c:n});var m=g[0].grid[a][n].ship;if(S(0,m)){g[0].ships[m].sunk=!0,g[1].score+=g[0].ships[m].def.pts;for(var x=g[0].ships[m],v=0;v<x.cells.length;v++){var k=P[0][x.cells[v].r*i+x.cells[v].c],F="2px";x.horiz?0===v?F="14px 4px 4px 14px":v===x.cells.length-1&&(F="4px 14px 14px 4px"):0===v?F="14px 14px 4px 4px":v===x.cells.length-1&&(F="4px 4px 14px 14px"),k.textContent=0===v?"ğŸ”¥":"ğŸ’€",k.style.cssText=C()+"background:radial-gradient(circle,rgba(255,100,0,0.4),rgba(200,50,0,0.2));border:1.5px solid rgba(255,100,0,0.6);box-shadow:0 0 18px rgba(255,100,0,0.5);border-radius:"+F+";font-size:0.9rem;cursor:default;"}if(L=L.filter(function(e){for(var r=0;r<x.cells.length;r++)if(x.cells[r].r===e.r&&x.cells[r].c===e.c)return!1;return!0}),e.rashidSay("Rashid sank your "+x.def.name+"! Firing again! ğŸ˜ˆ"),w(0))return u=!0,document.getElementById("bsBattSt").innerHTML='<span style="color:#ff6b6b;font-size:1.05rem">Rashid wins! All your ships sunk! ğŸ˜ˆ</span>',void e.endGame(g[0].score,c)}else e.rashidSay(t(["Rashid hits! Firing again! ğŸ’¥","Got one! Another shot! ğŸ˜","Boom! Again! ğŸ”¥"]))}else h.textContent="ğŸ’¨",h.style.cssText=C()+"background:linear-gradient(180deg,rgba(0,40,80,0.3),rgba(0,20,50,0.4));border:1px solid rgba(0,80,160,0.2);animation:bgRipple 0.6s ease;color:rgba(100,180,255,0.3);cursor:default;",e.rashidSay(t(["Rashid missed! Your turn! ğŸ”„","Splash! You're up! ğŸŒŠ","Miss! Go ahead! ğŸ˜Š"]));y||(b=0),H(),y&&!u&&p._tv.push(setTimeout(function(){B()},800))}}function H(){var e=document.getElementById("bsBattSt"),r=document.getElementById("bsScRow"),t=document.getElementById("bsShipRow");if(e){if("1p"===o){var a=0===b?"#4ecdc4":"#ff6b6b",n=0===b?"Your turn â€” fire at enemy waters!":"Rashid's turn...";e.innerHTML='ğŸš¢ <span style="color:'+a+'">'+n+'</span> <span style="font-size:0.7rem;color:rgba(255,255,255,0.4)">(Hit = fire again!)</span>',r.innerHTML='<span style="color:#4ecdc4">You: '+g[0].score+"/"+'14pts</span> <span style="color:rgba(255,255,255,0.2)">|</span> <span style="color:#ff6b6b">Rashid: '+g[1].score+"/"+"14pts</span>",t.innerHTML='<span style="color:#4ecdc4;font-size:0.62rem">You: '+d.map(function(e,r){return'<span style="opacity:'+(g[0].ships[r]&&g[0].ships[r].sunk?"0.3;text-decoration:line-through":"1")+'">'+e.emoji+e.len+"</span>"}).join(" ")+'</span> <span style="color:rgba(255,255,255,0.15)">|</span> <span style="color:#ff6b6b;font-size:0.62rem">Enemy: '+d.map(function(e,r){var t=g[1].ships[r]&&g[1].ships[r].sunk;return'<span style="opacity:'+(t?"0.3":"1")+'">'+(t?"ğŸ”¥":"â“")+e.len+"</span>"}).join(" ")+"</span>"}else{var s=0===b?"#4ecdc4":"#ff6b6b",i=0===b?"Player 1":"Player 2";e.innerHTML='ğŸš¢ <span style="color:'+s+'">'+i+' â€” Fire!</span> <span style="font-size:0.7rem;color:rgba(255,255,255,0.4)">(Hit = fire again!)</span>',r.innerHTML='<span style="color:#4ecdc4">P1: '+g[0].score+"/"+'14pts</span> <span style="color:rgba(255,255,255,0.2)">|</span> <span style="color:#ff6b6b">P2: '+g[1].score+"/"+"14pts</span>",t.innerHTML=""}var l=document.getElementById("bsBG0"),c=document.getElementById("bsBG1"),p=document.getElementById("bsBLbl0"),f=document.getElementById("bsBLbl1");0===b?(c&&(c.style.borderColor="rgba(255,107,107,0.5)"),l&&(l.style.borderColor="rgba(0,100,200,0.2)"),f&&(f.style.color="#ff6b6b"),p&&(p.style.color="rgba(78,205,196,0.5)")):(l&&(l.style.borderColor="rgba(78,205,196,0.5)"),c&&(c.style.borderColor="rgba(0,100,200,0.2)"),p&&(p.style.color="#4ecdc4"),f&&(f.style.color="rgba(255,107,107,0.5)"))}}return"1p"===o?(!function(e){for(var r=0;r<d.length;r++)for(var t=!1;!t;){var a=Math.random()>.5,n=Math.floor(Math.random()*i),o=Math.floor(Math.random()*i);y(e,n,o,d[r].len,a)&&(m(e,n,o,d[r].len,a),t=!0)}g[e].placed=!0}(1),T(0)):T(0),{}},destroy:function(){if(this._tv){for(var e=0;e<this._tv.length;e++)clearTimeout(this._tv[e]);this._tv=[]}}}),e.register({id:"minesweeper",name:"Gem Miner",emoji:"ğŸ’",category:"board",has2P:!1,init:function(t,a,i){for(var l="easy"===i?5:"hard"===i?7:6,d="easy"===i?4:"hard"===i?10:6,c=[],p=[],f=[],g=0;g<l*l;g++)c[g]=0,p[g]=!1,f[g]=!1;var b=r(Array.from({length:l*l},function(e,r){return r})).slice(0,d);b.forEach(function(e){c[e]=-1});for(var u=0;u<l;u++)for(var h=0;h<l;h++)if(-1!==c[u*l+h]){for(var y=0,m=-1;m<=1;m++)for(var x=-1;x<=1;x++){var v=h+x,S=u+m;v>=0&&v<l&&S>=0&&S<l&&-1===c[S*l+v]&&y++}c[u*l+h]=y}var w=!1,C=n(),k=l*l-d,F=0;C.innerHTML=o("msStatus","ğŸ’ Find safe cells! Avoid ğŸ’¥ sandstorms!")+s("msProgress","linear-gradient(90deg,#00C9A7,#FFD700)")+'<div style="display:flex;gap:10px;margin-bottom:8px;align-items:center"><button id="msFlagBtn" class="gbtn gbtn-outline" style="font-size:0.85rem;padding:6px 14px;border-radius:8px;cursor:pointer;transition:all 0.2s ease">ğŸš© Flag Mode: OFF</button><span style="font-family:Orbitron,sans-serif;font-size:0.8rem;color:rgba(255,255,255,0.5)" id="msSafeCount">Safe: 0/'+k+'</span></div><div class="gboard" style="grid-template-columns:repeat('+l+',50px);gap:3px;padding:10px;background:rgba(0,0,0,0.25);border-radius:14px;border:1px solid rgba(0,201,167,0.15)" id="msGrid"></div>',t.appendChild(C);for(var T=C.querySelector("#msGrid"),M=[],P=["","#4488ff","#00C9A7","#ff4444","#9b59b6","#FF6B35","#00C9A7","#FFD700","#ffffff"],E=0;E<l*l;E++){var A=document.createElement("div");A.className="gcell",A.style.cssText="height:50px;width:50px;font-size:0.95rem;font-weight:700;display:flex;align-items:center;justify-content:center;background:linear-gradient(145deg,rgba(25,25,50,0.9),rgba(18,18,38,0.95));border:1.5px solid rgba(0,201,167,0.2);border-radius:8px;cursor:pointer;transition:all 0.25s ease;box-shadow:0 2px 6px rgba(0,0,0,0.3);font-family:Orbitron,sans-serif",A.textContent="",A.setAttribute("data-i",E),A.onmouseenter=function(){this.classList.contains("ms-revealed")||L||(this.style.borderColor="rgba(0,201,167,0.5)",this.style.transform="scale(1.05)")},A.onmouseleave=function(){this.classList.contains("ms-revealed")||(this.style.borderColor="rgba(0,201,167,0.2)",this.style.transform="scale(1)")},T.appendChild(A),M.push(A)}C.querySelector("#msFlagBtn").onclick=function(){w=!w,this.textContent="ğŸš© Flag Mode: "+(w?"ON":"OFF"),this.style.background=w?"rgba(255,107,53,0.3)":"",this.style.borderColor=w?"rgba(255,107,53,0.6)":""};var L=!1;function B(r){if(!(p[r]||L||f[r])){if(p[r]=!0,M[r].classList.add("ms-revealed"),-1===c[r])return M[r].textContent="ğŸ’¥",M[r].style.background="radial-gradient(circle,rgba(255,50,50,0.5),rgba(200,0,0,0.3))",M[r].style.borderColor="rgba(255,50,50,0.6)",M[r].style.boxShadow="0 0 20px rgba(255,50,50,0.5)",M[r].style.animation="bgExplosion 0.5s ease",L=!0,e.rashidSay("Sandstorm! ğŸ’¥"),b.forEach(function(e){M[e].textContent="ğŸ’¥",M[e].style.background="radial-gradient(circle,rgba(255,50,50,0.3),rgba(200,0,0,0.15))",M[e].classList.add("ms-revealed")}),void e.endGame(F,k);var t;if(F++,t=Math.max(0,F/k*100),C.querySelector("#msProgress").style.width=t+"%",C.querySelector("#msSafeCount").textContent="Safe: "+F+"/"+k,M[r].style.background="linear-gradient(145deg,rgba(0,201,167,0.1),rgba(0,150,120,0.05))",M[r].style.borderColor="rgba(0,201,167,0.15)",M[r].style.animation="bgSparkle 0.4s ease",M[r].style.cursor="default",0===c[r]){M[r].textContent="";for(var a=r%l,n=Math.floor(r/l),o=-1;o<=1;o++)for(var s=-1;s<=1;s++){var i=a+s,d=n+o;i>=0&&i<l&&d>=0&&d<l&&B(d*l+i)}}else M[r].textContent=c[r],M[r].style.color=P[c[r]]||"#fff";F>=k&&(e.rashidSay("All safe! ğŸ’ğŸ‰"),C.querySelector("#msStatus").innerHTML='<span style="color:#FFD700;font-size:1.1rem">All gems found! ğŸ’ğŸ‰</span>',C.querySelector("#msStatus").style.animation="bgCelebrate 0.8s ease",e.endGame(k,k))}}return T.onclick=function(e){var r=e.target;if(r.hasAttribute("data-i")){var t=parseInt(r.getAttribute("data-i"));if(!p[t]&&!L)return w?(f[t]=!f[t],M[t].textContent=f[t]?"ğŸš©":"",void(M[t].style.borderColor=f[t]?"rgba(255,107,53,0.5)":"rgba(0,201,167,0.2)")):void B(t)}},{}},destroy:function(){}}),e.register({id:"dots-boxes",name:"Dots & Boxes",emoji:"ğŸ“¦",category:"board",has2P:!0,init:function(r,a,s){for(var i=[],l=[],d=[],c=0;c<4;c++){i[c]=[];for(var p=0;p<3;p++)i[c][p]=0}for(var f=0;f<3;f++){l[f]=[];for(var g=0;g<4;g++)l[f][g]=0}for(var b=0;b<3;b++){d[b]=[];for(var u=0;u<3;u++)d[b][u]=0}var h=1,y=0,m=0,x=!1,v=n();v.innerHTML=o("dbStatus",'<span style="color:#FFD700">Player 1 (ğŸŸ¡)</span> turn')+'<canvas id="dbCanvas" width="320" height="320" style="border-radius:14px;border:1px solid rgba(255,215,0,0.15);cursor:pointer;background:linear-gradient(145deg,rgba(10,10,25,0.95),rgba(5,5,15,0.98))"></canvas><div class="gtext gmt" id="dbScore" style="font-family:Orbitron,sans-serif;font-size:0.95rem"><span style="color:#FFD700">ğŸŸ¡ P1: 0</span> &nbsp;|&nbsp; <span style="color:#00C9A7">ğŸŸ¢ '+("2p"===a?"P2":"Rashid")+": 0</span></div>",r.appendChild(v);var S=v.querySelector("#dbCanvas"),w=S.getContext("2d"),C=72,k=22;function F(){w.fillStyle="rgba(8,8,20,1)",w.fillRect(0,0,320,320);for(var e=0;e<3;e++)for(var r=0;r<3;r++)1===d[e][r]?(w.fillStyle="rgba(255,215,0,0.12)",w.fillRect(k+r*C+3,k+e*C+3,66,66),w.strokeStyle="rgba(255,215,0,0.25)",w.lineWidth=1,w.strokeRect(k+r*C+3,k+e*C+3,66,66)):2===d[e][r]&&(w.fillStyle="rgba(0,201,167,0.12)",w.fillRect(k+r*C+3,k+e*C+3,66,66),w.strokeStyle="rgba(0,201,167,0.25)",w.lineWidth=1,w.strokeRect(k+r*C+3,k+e*C+3,66,66));for(var t=0;t<4;t++)for(var a=0;a<3;a++)w.strokeStyle=i[t][a]?1===i[t][a]?"#FFD700":"#00C9A7":"rgba(255,255,255,0.08)",w.lineWidth=i[t][a]?4:1.5,w.lineCap="round",w.beginPath(),w.moveTo(k+a*C,k+t*C),w.lineTo(k+(a+1)*C,k+t*C),w.stroke(),i[t][a]&&(w.shadowColor=1===i[t][a]?"rgba(255,215,0,0.4)":"rgba(0,201,167,0.4)",w.shadowBlur=8,w.beginPath(),w.moveTo(k+a*C,k+t*C),w.lineTo(k+(a+1)*C,k+t*C),w.stroke(),w.shadowBlur=0);for(var n=0;n<3;n++)for(var o=0;o<4;o++)w.strokeStyle=l[n][o]?1===l[n][o]?"#FFD700":"#00C9A7":"rgba(255,255,255,0.08)",w.lineWidth=l[n][o]?4:1.5,w.lineCap="round",w.beginPath(),w.moveTo(k+o*C,k+n*C),w.lineTo(k+o*C,k+(n+1)*C),w.stroke(),l[n][o]&&(w.shadowColor=1===l[n][o]?"rgba(255,215,0,0.4)":"rgba(0,201,167,0.4)",w.shadowBlur=8,w.beginPath(),w.moveTo(k+o*C,k+n*C),w.lineTo(k+o*C,k+(n+1)*C),w.stroke(),w.shadowBlur=0);for(var s=0;s<4;s++)for(var c=0;c<4;c++)w.shadowColor="rgba(255,215,0,0.6)",w.shadowBlur=8,w.fillStyle="#FFD700",w.beginPath(),w.arc(k+c*C,k+s*C,5,0,2*Math.PI),w.fill(),w.shadowBlur=0}function T(e,r){var t=0;return i[e]&&i[e][r]&&t++,i[e+1]&&i[e+1][r]&&t++,l[e]&&void 0!==l[e][r]&&l[e][r]&&t++,l[e]&&void 0!==l[e][r+1]&&l[e][r+1]&&t++,t}function M(){for(var e=!1,r=0;r<3;r++)for(var t=0;t<3;t++)0===d[r][t]&&i[r][t]&&i[r+1][t]&&l[r][t]&&l[r][t+1]&&(d[r][t]=h,1===h?y++:m++,e=!0);return e}function P(){for(var e=0;e<3;e++)for(var r=0;r<3;r++)if(0===d[e][r])return!1;return!0}function E(){F(),v.querySelector("#dbScore").innerHTML='<span style="color:#FFD700">ğŸŸ¡ P1: '+y+'</span> &nbsp;|&nbsp; <span style="color:#00C9A7">ğŸŸ¢ '+("2p"===a?"P2":"Rashid")+": "+m+"</span>";var e=1===h?"#FFD700":"#00C9A7",r=1===h?"Player 1 (ğŸŸ¡)":"2p"===a?"Player 2 (ğŸŸ¢)":"Rashid thinking...";v.querySelector("#dbStatus").innerHTML='<span style="color:'+e+'">'+r+" turn</span>"}function A(){if(!x){for(var r=[],n=0;n<4;n++)for(var o=0;o<3;o++)i[n][o]||r.push({t:"h",r:n,c:o});for(var c=0;c<3;c++)for(var p=0;p<4;p++)l[c][p]||r.push({t:"v",r:c,c:p});if(0!==r.length){if("easy"===s){var f=t(r);"h"===f.t?i[f.r][f.c]=2:l[f.r][f.c]=2}else{for(var g=null,b=0;b<r.length;b++){var u=r[b];"h"===u.t?i[u.r][u.c]=2:l[u.r][u.c]=2;for(var S=!1,w=0;w<3;w++)for(var C=0;C<3;C++)0===d[w][C]&&i[w][C]&&i[w+1][C]&&l[w][C]&&l[w][C+1]&&(S=!0);if("h"===u.t?i[u.r][u.c]=0:l[u.r][u.c]=0,S){g=u;break}}if(g)"h"===g.t?i[g.r][g.c]=2:l[g.r][g.c]=2;else if("hard"===s){var k=r.filter(function(e){"h"===e.t?i[e.r][e.c]=2:l[e.r][e.c]=2;for(var r=!1,t=0;t<3;t++)for(var a=0;a<3;a++)0===d[t][a]&&3===T(t,a)&&(r=!0);return"h"===e.t?i[e.r][e.c]=0:l[e.r][e.c]=0,!r}),F=k.length>0?t(k):t(r);"h"===F.t?i[F.r][F.c]=2:l[F.r][F.c]=2}else{var L=t(r);"h"===L.t?i[L.r][L.c]=2:l[L.r][L.c]=2}}var B=M();if(P()){x=!0,E();var H=y>m?"Player 1 wins!":m>y?"Rashid wins!":"Draw!";return v.querySelector("#dbStatus").innerHTML='<span style="color:#FFD700;font-size:1.1rem">'+H+"</span>",void e.endGame(y,y+m)}if(B){if("1p"===a)return E(),void setTimeout(A,400)}else h=1;E()}}}return S.onclick=function(r){if(2!==h||"1p"!==a){var t=S.getBoundingClientRect();!function(r,t){if(!x){for(var n=99,o="",s=0,d=0,c=0;c<4;c++)for(var p=0;p<3;p++){var f=k+p*C+36,g=k+c*C,b=Math.abs(r-f)+Math.abs(t-g);b<n&&!i[c][p]&&(n=b,o="h",s=c,d=p)}for(var u=0;u<3;u++)for(var S=0;S<4;S++){var w=k+S*C,F=k+u*C+36,T=Math.abs(r-w)+Math.abs(t-F);T<n&&!l[u][S]&&(n=T,o="v",s=u,d=S)}if(!(n>30)){"h"===o?i[s][d]=h:l[s][d]=h;var L=M();if(P()){x=!0,E();var B=y>m?"Player 1 wins!":m>y?"2p"===a?"Player 2 wins!":"Rashid wins!":"Draw!";return v.querySelector("#dbStatus").innerHTML='<span style="color:#FFD700;font-size:1.1rem">'+B+"</span>",void e.endGame(y,y+m)}L||(h=1===h?2:1),E(),2===h&&"1p"===a&&setTimeout(A,500)}}}(r.clientX-t.left,r.clientY-t.top)}},F(),{}},destroy:function(){}}),e.register({id:"lights-out",name:"Lights Out",emoji:"ğŸ’¡",category:"board",has2P:!1,init:function(r,t,a){for(var i="easy"===a?4:"hard"===a?6:5,l=[],d=0;d<i*i;d++)l[d]=Math.random()<.5;var c=0,p=0;l.forEach(function(e){e&&p++});var f=n();f.innerHTML=o("loStatus",'ğŸ’¡ Turn all lights OFF! &nbsp; <span class="bg-score">Moves: 0</span>')+s("loProgress","linear-gradient(90deg,#FFD700,#FF6B35)")+'<div style="display:flex;gap:10px;margin-bottom:8px;align-items:center"><span style="font-family:Orbitron,sans-serif;font-size:0.8rem;color:rgba(255,255,255,0.5)" id="loLitCount">Lights on: '+p+"</span>"+("easy"===a?'<button id="loHintBtn" class="gbtn gbtn-outline" style="font-size:0.75rem;padding:4px 10px;border-radius:8px;cursor:pointer">ğŸ’¡ Hint</button>':"")+'</div><div class="gboard" style="grid-template-columns:repeat('+i+',58px);gap:4px;padding:12px;background:rgba(0,0,0,0.3);border-radius:14px;border:1px solid rgba(255,215,0,0.1)" id="loGrid"></div>',r.appendChild(f);for(var g=f.querySelector("#loGrid"),b=[],u=0;u<i*i;u++){var h=document.createElement("div");h.className="gcell",h.style.cssText="height:58px;width:58px;font-size:1.6rem;display:flex;align-items:center;justify-content:center;border-radius:12px;cursor:pointer;transition:all 0.3s ease;border:2px solid rgba(255,215,0,0.15)",h.setAttribute("data-i",u),g.appendChild(h),b.push(h)}function y(){p=0;for(var e=0;e<i*i;e++)l[e]?(p++,b[e].textContent="ğŸ’¡",b[e].style.background="radial-gradient(circle at 50% 40%,rgba(255,235,150,0.4),rgba(255,215,0,0.15))",b[e].style.boxShadow="0 0 20px rgba(255,215,0,0.4),0 0 40px rgba(255,215,0,0.15)",b[e].style.borderColor="rgba(255,215,0,0.4)"):(b[e].textContent="â¬›",b[e].style.background="linear-gradient(145deg,rgba(15,15,30,0.9),rgba(10,10,20,0.95))",b[e].style.boxShadow="inset 0 2px 8px rgba(0,0,0,0.5)",b[e].style.borderColor="rgba(255,255,255,0.06)");var r=p>0?(i*i-p)/(i*i)*100:100;f.querySelector("#loProgress").style.width=r+"%",f.querySelector("#loLitCount").textContent="Lights on: "+p}if("easy"===a){var m=f.querySelector("#loHintBtn");m&&(m.onclick=function(){for(var e=0;e<i*i;e++)if(l[e]){b[e].style.animation="bgNeonPulse 0.5s ease 3",setTimeout(function(e){return function(){b[e].style.animation=""}}(e),1600);break}})}return g.onclick=function(r){var t=r.target;if(t.hasAttribute("data-i")){var a=parseInt(t.getAttribute("data-i"));!function(e){var r=e%i,t=Math.floor(e/i);l[e]=!l[e],r>0&&(l[e-1]=!l[e-1]),r<i-1&&(l[e+1]=!l[e+1]),t>0&&(l[e-i]=!l[e-i]),t<i-1&&(l[e+i]=!l[e+i])}(a),c++,y();var n=a%i,o=Math.floor(a/i),s=[a];n>0&&s.push(a-1),n<i-1&&s.push(a+1),o>0&&s.push(a-i),o<i-1&&s.push(a+i),s.forEach(function(e){b[e].style.animation="none",b[e].offsetHeight,b[e].style.animation="bgPulse 0.3s ease"}),f.querySelector("#loStatus").innerHTML='ğŸ’¡ Turn all lights OFF! &nbsp; <span class="bg-score">Moves: '+c+"</span>",l.every(function(e){return!e})&&(e.rashidSay("Brilliant! All off! ğŸŒ™"),f.querySelector("#loStatus").innerHTML='<span style="color:#FFD700;font-size:1.1rem">All lights off in '+c+" moves! ğŸŒ™ğŸ‰</span>",f.querySelector("#loStatus").style.animation="bgCelebrate 0.8s ease",e.endGame(Math.max(1,i*i-c),i*i))}},y(),{}},destroy:function(){}}),e.register({id:"sliding-puzzle",name:"Sliding Puzzle",emoji:"ğŸ§©",category:"board",has2P:!1,init:function(r,a,i){for(var l="easy"===i?3:"hard"===i?4:3,d=l*l,c=[],p=1;p<d;p++)c.push(p);c.push(0);for(var f="easy"===i?30:"hard"===i?500:200,g=0;g<f;g++){var b=c.indexOf(0),u=b%l,h=Math.floor(b/l),y=[];u>0&&y.push(-1),u<l-1&&y.push(1),h>0&&y.push(-l),h<l-1&&y.push(l);var m=t(y);c[b]=c[b+m],c[b+m]=0}var x=0,v=l<=3?80:65,S=n(),w=d-1;S.innerHTML=o("spStatus","ğŸ§© Order tiles 1-"+w+'! &nbsp; <span class="bg-score">Moves: 0</span>')+s("spProgress","linear-gradient(90deg,#00C9A7,#FFD700)")+'<div class="gboard" style="grid-template-columns:repeat('+l+","+v+'px);gap:5px;padding:12px;background:rgba(0,0,0,0.3);border-radius:14px;border:1px solid rgba(0,201,167,0.15)" id="spGrid"></div>',r.appendChild(S);var C=S.querySelector("#spGrid"),k=["#FF6B35","#FFD700","#00C9A7","#4ecdc4","#ff6b6b","#9b59b6","#3498db","#e74c3c","#2ecc71","#f39c12","#1abc9c","#e67e22","#16a085","#d35400","#8e44ad"];function F(){C.innerHTML="";var e=0;c.forEach(function(r,t){var a=document.createElement("div");a.className="gcell";var n=0!==r&&r===t+1;if(n&&e++,0===r)a.style.cssText="height:"+v+"px;width:"+v+"px;background:transparent;border:2px dashed rgba(255,255,255,0.06);border-radius:10px";else{var o=k[(r-1)%k.length];a.style.cssText="height:"+v+"px;width:"+v+"px;font-size:"+(l<=3?"1.6rem":"1.2rem")+";font-weight:800;font-family:Orbitron,sans-serif;display:flex;align-items:center;justify-content:center;background:linear-gradient(145deg,"+o+"cc,"+o+"88);border:2px solid "+o+";border-radius:10px;cursor:pointer;transition:all 0.2s ease;box-shadow:0 4px 12px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.2);color:#fff;text-shadow:0 1px 3px rgba(0,0,0,0.5)",n&&(a.style.borderColor="#00C9A7",a.style.boxShadow="0 4px 12px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.2),0 0 10px rgba(0,201,167,0.3)")}a.textContent=0===r?"":r,a.setAttribute("data-i",t),C.appendChild(a)});var r=e/w*100;S.querySelector("#spProgress").style.width=r+"%"}return C.onclick=function(r){var t=r.target;if(t.hasAttribute("data-i")){var a=parseInt(t.getAttribute("data-i")),n=c.indexOf(0),o=n%l,s=Math.floor(n/l),i=a%l,p=Math.floor(a/l);(1===Math.abs(o-i)&&s===p||1===Math.abs(s-p)&&o===i)&&(c[n]=c[a],c[a]=0,x++,F(),S.querySelector("#spStatus").innerHTML="ğŸ§© Order tiles 1-"+w+'! &nbsp; <span class="bg-score">Moves: '+x+"</span>",function(){for(var e=0;e<d-1;e++)if(c[e]!==e+1)return!1;return 0===c[d-1]}()&&(e.rashidSay("Solved! ğŸ§©ğŸ‰"),S.querySelector("#spStatus").innerHTML='<span style="color:#FFD700;font-size:1.1rem">Solved in '+x+" moves! ğŸ§©ğŸ‰</span>",S.querySelector("#spStatus").style.animation="bgCelebrate 0.8s ease",e.endGame(Math.max(1,4*d-x),4*d)))}},F(),{}},destroy:function(){}}),e.register({id:"tower-stack",name:"Tower Stack",emoji:"ğŸ—ï¸",category:"board",has2P:!1,_running:!1,init:function(r,t,a){var o=320,s=520,i=n();i.innerHTML='<div style="position:relative;display:inline-block"><canvas id="tsCanvas" width="320" height="520" style="border-radius:14px;cursor:pointer;display:block"></canvas><div id="tsHeightMeter" style="position:absolute;right:6px;top:30px;bottom:40px;width:14px;background:rgba(255,255,255,0.05);border-radius:7px;overflow:hidden"><div id="tsHeightFill" style="position:absolute;bottom:0;left:0;width:100%;height:0%;background:linear-gradient(0deg,#00C9A7,#FFD700);border-radius:7px;transition:height 0.3s ease"></div></div></div><div style="font-family:Inter,sans-serif;font-size:0.75rem;color:rgba(255,255,255,0.35);margin-top:6px">Click / Space / Tap to drop</div>',r.appendChild(i);var l=i.querySelector("#tsCanvas"),d=l.getContext("2d"),c="easy"===a?2:"hard"===a?4.5:3,p="easy"===a?.1:"hard"===a?.3:.2,f=[],g={x:0,w:80,dir:1,speed:c},b=490,u=25,h=0;this._running=!0;var y=this;f.push({x:120,w:80,y:b});var m="",x=0,v=0,S=[["#FF6B35","#ff8c5a"],["#FFD700","#ffe44d"],["#00C9A7","#33e0c0"],["#4ecdc4","#6ee0d8"],["#ff6b6b","#ff8e8e"],["#9b59b6","#b07cc6"],["#3498db","#5dade2"]];function w(){if(y._running){var r=f[f.length-1],t=Math.max(g.x,r.x),a=Math.min(g.x+g.w,r.x+r.w)-t;if(a<=0)return y._running=!1,m="GAME OVER",x=90,void e.endGame(h,h||1);var n=!1;Math.abs(g.x-r.x)<=3&&Math.abs(g.w-r.w)<=3?(t=r.x,a=r.w,n=!0,m="PERFECT!",x=60):a>.85*r.w&&(m="GREAT!",x=40);var o=b-f.length*u;f.push({x:t,w:a,y:o}),g.x=0,g.w=a,g.speed=Math.min(8,c+h*p),h++,n&&h++,e.setScore(h),h>=15&&(y._running=!1,e.rashidSay("15 blocks! Amazing! ğŸ—ï¸"),e.endGame(15,15))}}return e.loop(function(){if(y._running){g.x+=g.dir*g.speed,(g.x+g.w>300||g.x<20)&&(g.dir*=-1);var e=Math.max(0,f.length*u-420);v+=.08*(e-v),d.fillStyle="#0a0a18",d.fillRect(0,0,o,s),d.fillStyle="rgba(255,255,255,0.03)";for(var r=0;r<30;r++){var t=(73*r+17)%o,a=(47*r+31)%s;d.beginPath(),d.arc(t,a,1,0,2*Math.PI),d.fill()}var n=b+v;d.fillStyle="linear-gradient(0deg,#2a1a0a,#C4935A)",d.fillStyle="#C4935A",d.fillRect(0,n,o,s-n+50),d.fillStyle="#a07040",d.fillRect(0,n,o,3),f.forEach(function(e,r){var t=S[r%S.length],a=e.y+v;if(!(a>550||a<-30)){var n=d.createLinearGradient(e.x,a,e.x,a+u);n.addColorStop(0,t[1]),n.addColorStop(1,t[0]),d.fillStyle=n,d.fillRect(e.x,a,e.w,23),d.fillStyle="rgba(255,255,255,0.15)",d.fillRect(e.x+2,a,e.w-4,3),d.fillStyle="rgba(0,0,0,0.2)",d.fillRect(e.x,a+u-4,e.w,2),d.strokeStyle="rgba(0,0,0,0.15)",d.lineWidth=1,d.strokeRect(e.x,a,e.w,23)}});var l=b-f.length*u+v,c=S[f.length%S.length],p=d.createLinearGradient(g.x,l,g.x,l+u);if(p.addColorStop(0,c[1]),p.addColorStop(1,c[0]),d.fillStyle=p,d.fillRect(g.x,l,g.w,23),d.fillStyle="rgba(255,255,255,0.2)",d.fillRect(g.x+2,l,g.w-4,3),d.strokeStyle="rgba(255,255,255,0.3)",d.lineWidth=1,d.strokeRect(g.x,l,g.w,23),d.fillStyle="#fff",d.font="bold 20px Orbitron,sans-serif",d.textAlign="center",d.shadowColor="rgba(255,215,0,0.5)",d.shadowBlur=10,d.fillText("Height: "+h,160,25),d.shadowBlur=0,x>0){x--,d.save();var w=Math.min(1,x/20);d.globalAlpha=w,d.fillStyle="PERFECT!"===m?"#00C9A7":"#FFD700",d.font="bold 26px Orbitron,sans-serif",d.textAlign="center",d.shadowColor="PERFECT!"===m?"rgba(0,201,167,0.8)":"rgba(255,215,0,0.8)",d.shadowBlur=15,d.fillText(m,160,230+.3*(60-x)),d.shadowBlur=0,d.restore()}var C=Math.min(100,h/15*100);i.querySelector("#tsHeightFill").style.height=C+"%"}}),l.onclick=w,l.ontouchstart=function(e){e.preventDefault(),w()},this._keyHandler=function(e){"Space"===e.code&&(e.preventDefault(),w())},document.addEventListener("keydown",this._keyHandler),{}},destroy:function(){this._running=!1,this._keyHandler&&document.removeEventListener("keydown",this._keyHandler)}}),e.register({id:"pong",name:"Desert Pong",emoji:"ğŸ“",category:"board",has2P:!0,_running:!1,init:function(r,t,o){var s=520,i=370,l=n();l.innerHTML='<canvas id="pongCanvas" width="520" height="370" style="border-radius:14px;cursor:none;display:block"></canvas><div style="display:flex;justify-content:space-between;width:100%;max-width:520px;margin-top:6px;font-family:Inter,sans-serif;font-size:0.7rem;color:rgba(255,255,255,0.3)"><span>W/S - Player 1</span><span>'+("2p"===t?"Arrow Keys - Player 2":"AI - Rashid")+"</span></div>",r.appendChild(l);var d=l.querySelector("#pongCanvas").getContext("2d"),c=65,p=12,f="easy"===o?2:"hard"===o?5.5:3.5,g="easy"===o?25:"hard"===o?5:10,b="easy"===o?3.5:"hard"===o?5:4,u={y:185},h={y:185},y={x:260,y:185,vx:b,vy:2},m=0,x=0,v={},S=[],w=0,C=0,k="",F=0;this._running=!0;var T=this;return this._keyHandler=function(e){v[e.key]="keydown"===e.type},document.addEventListener("keydown",this._keyHandler),document.addEventListener("keyup",this._keyHandler),e.loop(function(){if(T._running){if((v.w||v.W)&&(u.y-=5),(v.s||v.S)&&(u.y+=5),u.y=a(u.y,32.5,337.5),"2p"===t?(v.ArrowUp&&(h.y-=5),v.ArrowDown&&(h.y+=5)):y.vx>0?h.y<y.y-g?h.y+=f:h.y>y.y+g&&(h.y-=f):"easy"===o&&(h.y<175?h.y+=1:h.y>195&&(h.y-=1)),h.y=a(h.y,32.5,337.5),y.x+=y.vx,y.y+=y.vy,(y.y<8||y.y>362)&&(y.vy*=-1),y.x-8<30&&y.y>u.y-32.5&&y.y<u.y+32.5&&y.vx<0&&(y.vx*=-1.02,y.vy+=.1*(y.y-u.y),C=8,Math.abs(y.vx)>1.3*b&&(k="SPEED UP!",F=30)),y.x+8>490&&y.y>h.y-32.5&&y.y<h.y+32.5&&y.vx>0&&(y.vx*=-1.02,y.vy+=.1*(y.y-h.y),C=8,Math.abs(y.vx)>1.3*b&&(k="SPEED UP!",F=30)),Math.abs(y.vx)>9&&(y.vx=y.vx>0?9:-9),y.x<0&&(x++,y.x=260,y.y=185,y.vx=b,y.vy=2,S=[],w=15),y.x>s&&(m++,y.x=260,y.y=185,y.vx=-b,y.vy=-2,S=[],w=15),m>=5)return T._running=!1,e.rashidSay("Player 1 wins! ğŸ†"),void e.endGame(m,5);if(x>=5){T._running=!1;var r="2p"===t?"Player 2":"Rashid";return e.rashidSay(r+" wins!"),void e.endGame(m,5)}S.push({x:y.x,y:y.y}),S.length>12&&S.shift(),d.fillStyle="#080818",d.fillRect(0,0,s,i),d.strokeStyle="rgba(255,215,0,0.08)",d.lineWidth=2,d.strokeRect(1,1,518,368),d.fillStyle="rgba(255,215,0,0.12)";for(var n=10;n<i;n+=18)d.beginPath(),d.arc(260,n,2.5,0,2*Math.PI),d.fill();d.shadowColor="rgba(255,215,0,0.6)",d.shadowBlur=15;var l=d.createLinearGradient(18,u.y-32.5,30,u.y-32.5);l.addColorStop(0,"#FFD700"),l.addColorStop(1,"#ffaa00"),d.fillStyle=l,d.beginPath(),d.roundRect(18,u.y-32.5,p,c,4),d.fill(),d.shadowBlur=0,d.shadowColor="rgba(0,201,167,0.6)",d.shadowBlur=15;var M=d.createLinearGradient(490,h.y-32.5,502,h.y-32.5);M.addColorStop(0,"#00C9A7"),M.addColorStop(1,"#00a88e"),d.fillStyle=M,d.beginPath(),d.roundRect(490,h.y-32.5,p,c,4),d.fill(),d.shadowBlur=0;for(var P=0;P<S.length;P++){var E=(P+1)/S.length*.4,A=(P+1)/S.length*8*.7;d.fillStyle="rgba(255,255,255,"+E+")",d.beginPath(),d.arc(S[P].x,S[P].y,A,0,2*Math.PI),d.fill()}d.shadowColor="rgba(255,255,255,0.8)",d.shadowBlur=12,d.fillStyle="#fff",d.beginPath(),d.arc(y.x,y.y,8,0,2*Math.PI),d.fill(),d.shadowBlur=0,d.fillStyle="rgba(255,255,255,0.4)",d.beginPath(),d.arc(y.x-2,y.y-2,3.2,0,2*Math.PI),d.fill(),C>0&&(C--,d.fillStyle="rgba(255,255,255,"+C/8*.15+")",d.fillRect(0,0,s,i)),d.textAlign="center",d.font="bold 32px Orbitron,sans-serif",d.shadowColor="rgba(255,215,0,0.7)",d.shadowBlur=12,d.fillStyle="#FFD700",d.fillText(m,205,45),d.shadowColor="rgba(0,201,167,0.7)",d.fillStyle="#00C9A7",d.fillText(x,315,45),d.shadowBlur=0,d.fillStyle="rgba(255,255,255,0.2)",d.font="bold 20px Orbitron,sans-serif",d.fillText("-",260,43),F>0&&(F--,d.save(),d.globalAlpha=Math.min(1,F/10),d.fillStyle="#FF6B35",d.font="bold 16px Orbitron,sans-serif",d.shadowColor="rgba(255,107,53,0.7)",d.shadowBlur=10,d.fillText(k,260,190),d.shadowBlur=0,d.restore()),d.fillStyle="rgba(255,255,255,0.2)",d.font="11px Inter,sans-serif",d.textAlign="left",d.fillText("W/S",18,360),d.textAlign="right",d.fillText("2p"===t?"â†‘/â†“":"AI",502,360),w>0&&(d.fillStyle="rgba(255,215,0,"+w/15*.2+")",d.fillRect(0,0,s,i),w--)}}),{}},destroy:function(){this._running=!1,this._keyHandler&&(document.removeEventListener("keydown",this._keyHandler),document.removeEventListener("keyup",this._keyHandler))}})}();