window.GamesEngine=function(){"use strict";var e={},t=null,a=null,n="1p",o="medium",i=0,r=null,c={};function s(e){return c[e]||(c[e]=document.getElementById(e))}function l(e){return e[Math.floor(Math.random()*e.length)]}function d(t){var r=e[t];if(r){a=t,i=0,s("gameOverlay").classList.add("open"),s("gameTopEmoji").textContent=r.emoji,s("gameTopName").textContent=r.name,s("gameTopScore").textContent="Score: 0",s("gameTopDiff").textContent="",s("gameOverScreen").style.display="none",s("gameModeScreen").style.display="flex",s("gameBody").style.display="none",s("gameModeEmoji").textContent=r.emoji,s("gameModeTitle").textContent=r.name;var c=s("gameMode2P");c&&(c.style.display=r.has2P?"":"none"),n="1p",o="medium",g(),u(),f();var d=s("gameModeRashidSpeech");d&&(d.textContent=l(["Pick a mode and let's play! ðŸŽ®","I'm ready! Choose wisely! ðŸ˜Š","Yalla! Let's see what you've got! ðŸŒŸ","Challenge me if you dare! ðŸ¤–"]))}}function m(){var i=e[a];i&&(s("gameModeScreen").style.display="none",s("gameBody").style.display="flex",s("gameTopDiff").textContent="2p"===n?"ðŸ‘¥ 2P":o.charAt(0).toUpperCase()+o.slice(1),s("gameStage").innerHTML="",h(l(["Let's play "+i.name+"! ðŸŽ®","This is fun! Ready? ðŸ˜Š","I love this game! Let's go! ðŸŒŸ","Yalla! Here we go! ðŸš€"])),t=i.init(s("gameStage"),n,o),window.Mascot&&Mascot.addHappiness&&Mascot.addHappiness(1))}function g(){var e=s("gameModeBot"),t=s("gameMode2P");e&&e.classList.toggle("active","1p"===n),t&&t.classList.toggle("active","2p"===n)}function u(){document.querySelectorAll(".game-mode-diff").forEach(function(e){e.classList.toggle("active",e.getAttribute("data-diff")===o)})}function f(){var e=s("gameDiffSection");e&&(e.style.display="1p"===n?"":"none")}function p(){if(r&&(cancelAnimationFrame(r),r=null),t&&e[a]&&e[a].destroy)try{e[a].destroy()}catch(e){}t=null}function y(){p(),s("gameOverlay").classList.remove("open"),s("gameStage").innerHTML="",s("gameBody").style.display="none",s("gameModeScreen").style.display="flex",a=null}function v(e){i=e;var t=s("gameTopScore");t&&(t.textContent="Score: "+e,t.classList.remove("gscore-pulse"),t.offsetWidth,t.classList.add("gscore-pulse"))}function h(e){var t=s("gameRashidBubble");t&&(t.textContent=e,t.style.animation="none",t.offsetWidth,t.style.animation="bubblePop 0.3s ease")}function M(){!function(){var t=s("gamesGrid");if(t){t.innerHTML="",Object.keys(e).forEach(function(a){var n=e[a],o=document.createElement("div");o.className="game-card",o.setAttribute("data-cat",n.category),o.innerHTML=(n.has2P?'<span class="game-card-2p">2P</span>':"")+'<span class="game-card-emoji">'+n.emoji+'</span><span class="game-card-name">'+n.name+'</span><span class="game-card-cat">'+n.category+"</span>",o.onclick=function(){d(a)},t.appendChild(o)});var a=document.querySelectorAll(".games-tab");a.forEach(function(e){e.onclick=function(){a.forEach(function(e){e.classList.remove("active")}),e.classList.add("active");var n=e.getAttribute("data-cat");t.querySelectorAll(".game-card").forEach(function(e){e.style.display="all"===n||e.getAttribute("data-cat")===n?"":"none"})}})}}(),s("gameBackBtn")&&(s("gameBackBtn").onclick=y),s("gameOverReplay")&&(s("gameOverReplay").onclick=function(){if(s("gameOverScreen").style.display="none",a){s("gameBody").style.display="flex",s("gameStage").innerHTML="",i=0,s("gameTopScore").textContent="Score: 0";var r=e[a];r&&(h(l(["Let's go again! ðŸ”„","Round two! ðŸ’ª","I'm ready! ðŸŽ®"])),t=r.init(s("gameStage"),n,o))}}),s("gameOverBack")&&(s("gameOverBack").onclick=y);var r=s("gameModeBot"),c=s("gameMode2P");r&&(r.onclick=function(){n="1p",g(),f()}),c&&(c.onclick=function(){n="2p",g(),f()}),document.querySelectorAll(".game-mode-diff").forEach(function(e){e.onclick=function(){o=e.getAttribute("data-diff"),u()}});var p=s("gameModePlay");p&&(p.onclick=m)}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",M):setTimeout(M,0),{register:function(t){e[t.id]=t},launch:d,endGame:function(e,t){i=e,p();var a=t>0?e/t:0,n=a>=.9?3:a>=.6?2:a>0?1:0,o=10*e+(3===n?25:0);window.Progression&&(Progression.addXP(o),window.Mascot&&Mascot.addHappiness&&Mascot.addHappiness(n>=2?2:1)),3===n?(h("PERFECT! You're amazing! ðŸŒŸðŸŽ‰"),function(){for(var e=["#FFD700","#FF6B35","#00C9A7","#4ecdc4","#ff6b6b","#9b59b6","#3498db"],t=0;t<40;t++)(function(t){setTimeout(function(){var t=document.createElement("div");t.className="gconfetti",t.style.left=100*Math.random()+"vw",t.style.background=e[Math.floor(Math.random()*e.length)],t.style.width=5+8*Math.random()+"px",t.style.height=5+8*Math.random()+"px",t.style.animationDuration=1.5+1.5*Math.random()+"s",document.body.appendChild(t),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},3500)},t)})(40*t)}()):h(n>=2?"Great job! ðŸ‘ðŸ˜Š":e>0?"Good try! Keep it up! ðŸ’ª":"Don't give up! Try again! ðŸ˜Š"),s("gameOverEmoji").textContent=3===n?"ðŸ†":n>=2?"ðŸŽ‰":"ðŸ‘",s("gameOverTitle").textContent=3===n?"Perfect Score!":"Game Over!",s("gameOverScore").textContent="Score: "+e+(t>0?" / "+t:""),s("gameOverStars").textContent="â­".repeat(n)+"â˜†".repeat(3-n),s("gameOverXP").textContent="+"+o+" XP",s("gameOverScreen").style.display="flex"},backToHub:y,setScore:v,addScore:function(e){v(i+(e||1))},getScore:function(){return i},getMode:function(){return n},getDifficulty:function(){return o},rashidSay:h,makeCanvas:function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,a.style.width=Math.min(e,500)+"px",a.style.height=Math.min(t,500)+"px",a.style.background="#0a0a12",a.style.borderRadius="12px",a.style.border="1.5px solid rgba(255,215,0,0.15)",a},loop:function(e){r=requestAnimationFrame(function t(a){e(a),r=requestAnimationFrame(t)})},shuffle:function(e){for(var t=e.slice(),a=t.length-1;a>0;a--){var n=Math.floor(Math.random()*(a+1)),o=t[a];t[a]=t[n],t[n]=o}return t},pick:l,clamp:function(e,t,a){return Math.max(t,Math.min(a,e))},el:s,getStage:function(){return s("gameStage")}}}();